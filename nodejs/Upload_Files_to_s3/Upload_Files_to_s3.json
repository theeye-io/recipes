{"task":{"enable":true,"type":"script","public":false,"tags":[],"grace_time":0,"task_arguments":[{"id":1,"order":0,"type":"input","label":"Files to Upload","help":"","readonly":false,"required":true,"masked":false,"charsmin":0,"charsmax":0,"charset":null,"pattern":"","options":[]}],"output_parameters":[],"register_body":false,"execution_count":29,"multitasking":true,"user_inputs":false,"user_inputs_members":[],"show_result":false,"script_arguments":[{"id":1,"order":0,"type":"input","label":"Files to Upload","help":"","readonly":false,"required":true,"masked":false,"charsmin":0,"charsmax":0,"charset":null,"pattern":"","options":[]}],"logging":false,"_type":"ScriptTask","creation_date":"2020-07-31T12:17:23.091Z","last_update":"2020-09-11T09:02:05.094Z","env":{"AWS_ACCESS_KEY_ID":"","AWS_SECRET_ACCESS_KEY":"","AWS_REGION":"","AWS_S3_BUCKET":"","AWS_S3_BUCKET_DIRECTORY":"","UPLOADED_PATH":""},"name":"Upload Files to s3","description":"","timeout":600000,"script_runas":"\"/usr/bin/node\" %script%","template":null,"template_id":null,"source_model_id":"5f240bd30ffe1b0012f34182","script_id":"5f240bd20ffe1b0012f34181"},"file":{"filename":"uploadToS3.js","keyname":"uploadToS3.js[ts:1596802261156]","mimetype":"text/javascript","extension":"js","size":1523,"description":"","md5":"e154d2c886c936e78da3c02116f4db68","public":false,"tags":[],"source_model_id":"5f240bd20ffe1b0012f34181","data":"Y29uc3QgZnMgPSByZXF1aXJlKCdmcycpCmNvbnN0IEFXUyA9IHJlcXVpcmUoJ2F3cy1zZGsnKQpjb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpCgpsZXQgczMKCmNvbnN0IG1haW4gPSBhc3luYyAoKSA9PiB7Cgl0cnkgewogICAgczMgPSBuZXcgQVdTLlMzKHsKICAgICAgYWNjZXNzS2V5SWQ6IHByb2Nlc3MuZW52LkFXU19BQ0NFU1NfS0VZX0lELAogICAgICBzZWNyZXRBY2Nlc3NLZXk6IHByb2Nlc3MuZW52LkFXU19TRUNSRVRfQUNDRVNTX0tFWSwKICAgICAgcmVnaW9uOiBwcm9jZXNzLmVudi5BV1NfUkVHSU9OCiAgICB9KQoKICAgIGNvbnN0IGJ1Y2tldCA9IHByb2Nlc3MuZW52LkFXU19TM19CVUNLRVQKICAgIGNvbnN0IGJ1Y2tldERpcmVjdG9yeSA9IHByb2Nlc3MuZW52LkFXU19TM19CVUNLRVRfRElSRUNUT1JZCiAgICBjb25zdCB1cGxvYWRlZFBhdGggPSBwcm9jZXNzLmVudi5VUExPQURFRF9QQVRICgogICAgY29uc3Qgb3JpZ2luUGF0aCA9IHByb2Nlc3MuYXJndlsyXQoKICAgIGlmICghZnMuZXhpc3RzU3luYyh1cGxvYWRlZFBhdGgpKSB7CiAgICAgIGZzLm1rZGlyU3luYyh1cGxvYWRlZFBhdGgpCiAgICB9CgoJCWxldCBmaWxlcyA9IGZzLnJlYWRkaXJTeW5jKG9yaWdpblBhdGgpCiAgICBsZXQgcmVwb3J0ID0gW10gLy8gdXBsb2FkZWQgZmlsZXMgbmFtZXMKCiAgICBmb3IgKGxldCBmaWxlbmFtZSBvZiBmaWxlcykgewogICAgICBsZXQgb3B0aW9ucyA9IHsKICAgICAgICBidWNrZXQsCiAgICAgICAga2V5OiBgJHtidWNrZXREaXJlY3Rvcnl9LyR7ZmlsZW5hbWV9YCwKICAgICAgICBmaWxlOiBwYXRoLmpvaW4ob3JpZ2luUGF0aCwgZmlsZW5hbWUpCiAgICAgIH0KICAgICAgYXdhaXQgdXBsb2FkRmlsZVMzKG9wdGlvbnMpCiAgICAgIGZzLnJlbmFtZVN5bmMoIHBhdGguam9pbihvcmlnaW5QYXRoLCBmaWxlbmFtZSksIHBhdGguam9pbih1cGxvYWRlZFBhdGgsIGZpbGVuYW1lKSApCgogICAgICByZXBvcnQucHVzaChmaWxlbmFtZSkKICAgIH0KCiAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeSh7IHN0YXRlOiAnc3VjY2VzcycsIGRhdGE6IFtyZXBvcnRdIH0pKQoJfSBjYXRjaCAoZXJyKSB7CgkJY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoeyBzdGF0ZTogJ2ZhaWx1cmUnLCBkYXRhOiBbZXJyLm1lc3NhZ2VdIH0pKQoJCXByb2Nlc3MuZXhpdCgpCgl9Cn0KCmNvbnN0IHVwbG9hZEZpbGVTMyA9IGFzeW5jKHsgYnVja2V0LCBrZXksIGZpbGUgfSkgPT4gewogIGxldCBzdHJlYW0gPSBmcy5jcmVhdGVSZWFkU3RyZWFtKGZpbGUpIC8vIHVzZSBzdHJlYW1zIGZvciBiZXR0ZXIgcGVyZm9ybWFuY2UKCiAgY29uc3QgcGFyYW1zID0gewogICAgQnVja2V0OiBidWNrZXQsCiAgICBLZXk6IGtleSwKICAgIEJvZHk6IHN0cmVhbQogIH0KCiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgczMudXBsb2FkKHBhcmFtcykucHJvbWlzZSgpCiAgY29uc29sZS5sb2coYEZpbGUgdXBsb2FkZWQgc3VjY2Vzc2Z1bGx5IGF0ICR7cmVzdWx0LkxvY2F0aW9ufWApCn0KCm1haW4oKQo="}}
