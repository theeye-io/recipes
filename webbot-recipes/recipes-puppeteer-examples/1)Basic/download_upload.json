{"task":{"enable":true,"type":"script","public":false,"tags":["1)basic"],"grace_time":0,"task_arguments":[],"output_parameters":[],"register_body":false,"execution_count":2,"multitasking":true,"user_inputs":false,"show_result":false,"script_arguments":[],"_type":"ScriptTask","creation_date":"2020-03-27T18:42:34.684Z","last_update":"2020-03-30T20:17:51.680Z","name":"download_upload","description":"Find an image by class selector, downloads the image, saves it to disk and read it again. Use this together with a .fileUpload() method.","timeout":600000,"script_runas":"","template":null,"template_id":null,"source_model_id":"5e7e491a61b3b90012b4aa3d","env":{},"script_id":"5e7e49187b1fae001174ebaa"},"file":{"filename":"download_upload.js","keyname":"download_upload.js[ts:1585335783861]","size":1054,"description":"","md5":"c71f25e22d2464c095c90ae8810d0ab2","public":false,"tags":[],"source_model_id":"5e7e49187b1fae001174ebaa","data":"IyEvdXNyL2Jpbi9ub2RlCgpjb25zdCBwdXBwZXRlZXIgPSByZXF1aXJlKCdwdXBwZXRlZXInKQpjb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJykKY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKQpjb25zdCB7IHByb21pc2lmeSB9ID0gcmVxdWlyZSgndXRpbCcpCgpjb25zdCByZWFkRmlsZUFzeW5jID0gcHJvbWlzaWZ5KGZzLnJlYWRGaWxlKQpjb25zdCB3cml0ZUZpbGVBc3luYyA9IHByb21pc2lmeShmcy53cml0ZUZpbGUpOwoKdHJ5IHsKICAoYXN5bmMgKCkgPT4gewogICAgY29uc3QgYnJvd3NlciA9IGF3YWl0IHB1cHBldGVlci5sYXVuY2goe2FyZ3M6IFsnLS1uby1zYW5kYm94J119KTsKICAgIGNvbnN0IHBhZ2UgPSBhd2FpdCBicm93c2VyLm5ld1BhZ2UoKTsKICAgIGF3YWl0IHBhZ2Uuc2V0Vmlld3BvcnQoeyB3aWR0aDogMTIwMCwgaGVpZ2h0OiA4MDAgfSk7CgogICAgYXdhaXQgcGFnZS5nb3RvKCJodHRwczovL2NoZWNrbHlocS5jb20vIik7CiAgICBjb25zdCBpbWFnZUhyZWYgPSBhd2FpdCBwYWdlLmV2YWx1YXRlKChzZWwpID0+IHsKICAgICAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsKS5nZXRBdHRyaWJ1dGUoJ3NyYycpLnJlcGxhY2UoJy8nLCAnJyk7CiAgICB9LCAnLmhlcm8taW1hZ2UnKTsKCiAgICBjb25zdCB2aWV3U291cmNlID0gYXdhaXQgcGFnZS5nb3RvKCJodHRwczovL2NoZWNrbHlocS5jb20vIiArIGltYWdlSHJlZik7CiAgICBjb25zdCBidWZmZXIgPSBhd2FpdCB2aWV3U291cmNlLmJ1ZmZlcigpCiAgICBhd2FpdCB3cml0ZUZpbGVBc3luYyhwYXRoLmpvaW4oX19kaXJuYW1lLCAiY2hlY2tseS5wbmciKSwgYnVmZmVyKQogICAgY29uc29sZS5sb2coIlRoZSBmaWxlIHdhcyBzYXZlZCEiKQoKICAgIGF3YWl0IHJlYWRGaWxlQXN5bmMocGF0aC5qb2luKF9fZGlybmFtZSwgJ2NoZWNrbHkucG5nJykpCiAgICBjb25zb2xlLmxvZygiVGhlIGZpbGUgd2FzIHJlYWQhIikKICAgIGJyb3dzZXIuY2xvc2UoKQogIH0pKCkKfWNhdGNoIChlcnIpIHsKICBjb25zb2xlLmxvZygiZmFpbCIpCiAgcHJvY2Vzcy5leGl0KCkKfQ=="}}